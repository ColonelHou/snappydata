hydra.Prms-testRequirement = "Test to verify cluster recovery when a new server node starts first in the existing cluster.";
hydra.Prms-testDescription = "Test to verify cluster recovery when a new server node starts first in the existing cluster. ";

INCLUDE $JTESTS/io/snappydata/hydra/cluster/startEmbeddedModeCluster.conf;

INITTASK    taskClass   = io.snappydata.hydra.cluster.SnappyTest taskMethod  = HydraTask_executeSQLScripts
            io.snappydata.hydra.cluster.SnappyPrms-sqlScriptNames = createAndLoadMixedTables.sql
            io.snappydata.hydra.cluster.SnappyPrms-dataLocation = ${dataFilesLocation}
            threadGroups = snappyInitThread;

//Do Validation take data count of all the tables loaded.
INITTASK    taskClass  = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = storeDataCount
            threadGroups = snappyInitThread;


//Start a new server node first.
INITTASK    taskClass  = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = addNewNode
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-nodeConfig="dev11 -dir=/nfs/users/spillai/tmgdata/lead -locators=dev11:10334 -heap-size=4g -memory-size=4g -critical-heap-percentage=95 -spark.local.dir=/nfs/users/spillai/tmp"
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-snappyFileLoc = ${snappyFileLoc}
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-nodeType = servers
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-isNewNodeFirst = true
            threadGroups = snappyInitThread;

INITTASK    taskClass  = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = validateDataCount
            threadGroups = snappyInitThread;

//Start lead node first and then the servers.
INITTASK    taskClass  = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = addNewNode
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-nodeConfig="dev11 -dir=/nfs/users/spillai/tmgdata/lead -locators=dev11:10334 -heap-size=4g -memory-size=4g -critical-heap-percentage=95 -spark.local.dir=/nfs/users/spillai/tmp"
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-snappyFileLoc = ${snappyFileLoc}
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-nodeType = leads
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-isNewNodeFirst = true
            threadGroups = snappyInitThread;

INITTASK    taskClass  = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = validateDataCount
            threadGroups = snappyInitThread;


io.snappydata.hydra.cluster.SnappyPrms-userAppJar = snappydata-store-scala-tests*tests.jar;
io.snappydata.hydra.cdcConnector.SnappyCDCPrms-hostName = ONEOF dev11 dev10 dev7 dev9 FOENO;

INCLUDE $JTESTS/io/snappydata/hydra/cluster/stopEmbeddedModeCluster.conf;